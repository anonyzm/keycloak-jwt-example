# –û—Ç–ª–∞–¥–∫–∞ Interceptor –¥–ª—è 401 –æ—à–∏–±–æ–∫

## –ü—Ä–æ–±–ª–µ–º–∞
Interceptor –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ 401 –æ—à–∏–±–æ–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ 401 –∫–æ–¥–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –£–±—Ä–∞–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ interceptor'—ã
- –í `authService.ts` –±—ã–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ axios interceptor'—ã
- –í `httpClient.ts` –±—ã–ª–∏ –¥—Ä—É–≥–∏–µ interceptor'—ã
- –≠—Ç–æ —Å–æ–∑–¥–∞–≤–∞–ª–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç

### 2. –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ httpClient
- `authService` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `httpClient` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ axios
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π interceptor

### 3. –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–æ–±–∞–≤–ª–µ–Ω—ã —ç–º–æ–¥–∑–∏ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –ª–æ–≥–æ–≤
- –õ–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–µ—Ç–∞–ª–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤

## –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è:
- `üîë Added token to request: /auth/guest-token`
- `‚úÖ Successfully refreshed guest token, retrying request...`

### 3. –°–¥–µ–ª–∞–π—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω–µ—Ç 401
–ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É —ç–Ω–¥–ø–æ–∏–Ω—Ç—É –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è:
- `üîê Received 401 error, attempting to refresh guest token...`
- `‚úÖ Successfully refreshed guest token, retrying request...`
- `üîÑ Retrying request with new token...`

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. CORS –æ—à–∏–±–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend —Ä–∞–∑—Ä–µ—à–∞–µ—Ç CORS
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `baseURL` –≤ `httpClient` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

### 2. –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `authService.getToken()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `forceRefreshGuestToken()` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 3. –ó–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- Interceptor –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ–¥–Ω—É –ø–æ–ø—ã—Ç–∫—É –ø–æ–≤—Ç–æ—Ä–∞ (`_retry` —Ñ–ª–∞–≥)
- –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ backend

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
frontend/src/services/
‚îú‚îÄ‚îÄ httpClient.ts      # –û—Å–Ω–æ–≤–Ω–æ–π HTTP –∫–ª–∏–µ–Ω—Ç —Å interceptor'–∞–º–∏
‚îú‚îÄ‚îÄ authService.ts     # –°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç httpClient)
‚îî‚îÄ‚îÄ demoService.ts     # –î–µ–º–æ —Å–µ—Ä–≤–∏—Å (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç httpClient)
```

## –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π —Ä–∞–±–æ—Ç–µ interceptor'–∞ –≤—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:
1. `üîë Added token to request: [URL]` - —Ç–æ–∫–µ–Ω –¥–æ–±–∞–≤–ª–µ–Ω –∫ –∑–∞–ø—Ä–æ—Å—É
2. `üîê Received 401 error, attempting to refresh guest token...` - –ø–æ–ª—É—á–µ–Ω–∞ 401 –æ—à–∏–±–∫–∞
3. `‚úÖ Successfully refreshed guest token, retrying request...` - —Ç–æ–∫–µ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω
4. `üîÑ Retrying request with new token...` - –∑–∞–ø—Ä–æ—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è
5. `üîë Added token to request: [URL]` - –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –¥–æ–±–∞–≤–ª–µ–Ω –∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –∑–∞–ø—Ä–æ—Å—É
