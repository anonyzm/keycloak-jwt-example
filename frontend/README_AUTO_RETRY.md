# Автоматический перезапрос данных после авторизации

## Что добавлено

### 1. Автоматический перезапрос
- После успешной авторизации автоматически перезапрашиваются данные последней активной кнопки
- Задержка 500мс для обновления токена
- Сохраняется информация о последней нажатой кнопке

### 2. Использование React.forwardRef
- `DemoButtons` теперь использует `React.forwardRef` для экспорта функций
- `App.tsx` получает доступ к функциям `DemoButtons` через ref
- Функция `handleAuthSuccess` вызывается после успешной авторизации

### 3. Логика работы
1. Пользователь нажимает на кнопку (например, "User only")
2. Получает 403 ошибку (доступ запрещен)
3. Открывается модальное окно авторизации
4. После успешной авторизации автоматически перезапрашиваются данные для кнопки "User only"

## Изменения в коде

### DemoButtons.tsx
```tsx
// Экспорт функции через ref
React.useImperativeHandle(ref, () => ({
  handleAuthSuccess
}));

// Функция для перезапроса данных
const handleAuthSuccess = () => {
  setTimeout(() => {
    retryLastRequest();
  }, 500);
};
```

### App.tsx
```tsx
// Ref для доступа к DemoButtons
const demoButtonsRef = React.useRef<{ handleAuthSuccess: () => void }>(null);

// Вызов функции DemoButtons после авторизации
const handleDemoButtonsAuthSuccess = () => {
  if (demoButtonsRef.current) {
    demoButtonsRef.current.handleAuthSuccess();
  }
};
```

## Преимущества

1. **Лучший UX**: Пользователь не должен повторно нажимать на кнопку после авторизации
2. **Автоматизация**: Система сама понимает, какие данные нужно перезапросить
3. **Сохранение контекста**: Запоминается последняя активная кнопка
4. **Безопасность**: Задержка обеспечивает обновление токена перед запросом

## Тестирование

1. Нажмите на кнопку "User only" без авторизации
2. Получите 403 ошибку
3. Авторизуйтесь через модальное окно
4. Данные автоматически загрузятся для кнопки "User only"
